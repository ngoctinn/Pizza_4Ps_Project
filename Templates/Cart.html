<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pizza 4ps</title>
    <!-- bootstrap -->
    <link
      rel="stylesheet"
      href="../assets/bootstrap-5.3.3-dist/css/bootstrap.min.css"
    />
    <!-- link cnd -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css"
    />
    <link
      rel="stylesheet"
      href="../assets/font-awesome-pro-v6-6.2.0/css/all.min.css"
    />

    <link rel="stylesheet" href="../assets/css/reset.css" />

    <!-- script -->
    <script src="../assets/js/scripts.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.4.5/swiper-bundle.min.js"></script>
    <!-- <script src="../assets/bootstrap-5.3.3-dist/js/bootstrap.bundle.min.js"></script> -->
    <!-- CSS -->
    <link rel="stylesheet" href="../assets/css/flickity.min.css" />
    <!-- <link rel="stylesheet" href="../assets/css/reset.css" /> -->
    <link rel="stylesheet" href="../assets/css/styles.css" />
    <link
      rel="stylesheet"
      href="../assets/font-awesome-pro-v6-6.2.0/css/all.min.css"
    />
    <link rel="stylesheet" href="../assets/css/navbar.css" />
    <link rel="stylesheet" href="../assets/css/notification.css" />
    <link rel="stylesheet" href="../assets/css/Cart.css" />
    <link rel="stylesheet" href="../assets/css/footer.css" />

    <!-- font awaresome -->
    <link
      rel="stylesheet"
      href="../assets/font-awesome-pro-v6-6.2.0/css/all.min.css"
    />
    <!-- Fonts -->
    <link rel="stylesheet" href="../assets/fonts/stylesheet.css" />
    <!-- Favicon -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="../assets/favicon/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="../assets/favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="../assets/favicon/favicon-16x16.png"
    />
    <link rel="manifest" href="../assets/favicon/site.webmanifest" />
    <link
      rel="mask-icon"
      href="../assets/favicon/safari-pinned-tab.svg"
      color="#5bbad5"
    />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="theme-color" content="#ffffff" />
  </head>
  <body>
    <header>
      <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <!-- Logo -->
        <a class="navbar-brand logo-style" href="#">Pizza 4p's</a>

        <!-- Hamburger button for mobile -->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarContent"
          aria-controls="navbarContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Navbar content -->
        <div class="collapse navbar-collapse" id="navbarContent">
          <!-- Nav Links -->
          <ul class="navbar-nav me-auto mb-2 ms-lg-5 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="./Index.html">Trang chủ</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="./Index.html">Sản phẩm</a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                onclick="scrollToFooter()"
                style="cursor: pointer"
                >Liên hệ</a
              >
            </li>
          </ul>

          <!-- Search Form -->
          <form
            id="search-form"
            class="d-flex mx-auto mb-2 mb-lg-0 ms-lg-5 w-100"
          >
            <div class="search-container">
              <input
                id="search-input"
                class="form-control my-form-control form__input"
                type="search"
                placeholder="Tìm kiếm..."
                aria-label="Search"
              />
              <button
                class="btn btn__search"
                onclick="window.location.href = './Index-timkiem.html'"
                type="button"
              >
                <i class="fas fa-search"></i>
              </button>
            </div>
          </form>

          <!-- Auth Buttons -->
          <div class="d-flex ms-lg-5">
            <a href="../Templates/sign-in_sign-up.html"
              ><button class="btn__login" type="button">Đăng nhập</button></a
            >
            <!-- Cart -->
            <!-- <div class="cart-wrapper">
              <button class="cart-button">
                <svg
                  class="cart-icon"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <circle cx="9" cy="21" r="1"></circle>
                  <circle cx="20" cy="21" r="1"></circle>
                  <path
                    d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"
                  ></path>
                </svg>
                <span class="cart-count" id="cart-quanlity">3</span>
              </button>

              <div class="cart-dropdown">
                <div class="cart-header">Giỏ hàng</div>
                <div class="cart-items">
                  <div class="cart-item">
                    <img
                      src="../assets/img/products/PZ_Banhpizza.webp"
                      alt="Product 1"
                      class="cart-item-image"
                    />
                    <div class="cart-item-details">
                      <div class="cart-item-name">Sản phẩm 1</div>
                      <div class="cart-item-price">200.000đ x 1</div>
                    </div>
                  </div>
                  <div class="cart-item">
                    <img
                      src="../assets/img/products/PZ_CaHoiXotKemMiSo.webp"
                      alt="Product 2"
                      class="cart-item-image"
                    />
                    <div class="cart-item-details">
                      <div class="cart-item-name">Sản phẩm 2</div>
                      <div class="cart-item-price">350.000đ x 2</div>
                    </div>
                  </div>
                </div>
                <div class="cart-total">
                  <span>Tổng cộng:</span>
                  <span>900.000đ</span>
                </div>
                <a
                  href="#"
                  onclick="toast({
                  title: 'Thông báo',
                  message: 'Bạn đang trong giỏ hàng',
                  type: 'info'
                })"
                  class="view-cart-btn"
                  >Xem giỏ hàng</a
                >
              </div>
            </div> -->

            <!-- Profile -->
            <div class="nav-profile">
              <button class="profile-trigger">
                <img
                  src="../assets/img/user.jpg"
                  alt="User avatar"
                  class="avatar"
                />
                <span class="user-name"></span>
              </button>

              <div class="dropdown-content">
                <div class="user-info">
                  <div class="user-name">Nguyễn Ngọc Tín</div>
                  <div class="user-email">ngoctinn.work@gmail.com</div>
                </div>
                <a href="./lichsu-donhang.html" class="history-btn">
                  <i class="fa-regular fa-timer"></i>
                  Lịch sử đơn hàng
                </a>
                <button class="logout-btn" onclick="logout_cart()">
                  <svg
                    class="logout-icon"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                  </svg>
                  Đăng xuất
                </button>
              </div>
            </div>
          </div>
        </div>
      </nav>
    </header>
    <main>
      <div class="checkout-container">
        <div class="product-cards-container">
          <!-- nút trở lại trang sản phẩm -->
          <a href="./Index.html" class="back-to-shop">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
              width="20"
              height="20"
            >
              <path d="M15 18l-6-6 6-6"></path>
            </svg>

            Trở lại trang sản phẩm
          </a>

          <div class="product-list">
            <div class="cart-item cart-item-cart">
              <img
                src="../assets/img/products/PZ_TomXotToiCay.webp"
                alt="Pizza Tôm Xốt Tỏi Cay"
                class="cart-item-image cart-item-image-cart"
              />
              <div class="cart-item-details">
                <div class="cart-item-name cart-item-name-cart">
                  Pizza Tôm Xốt Tỏi Cay
                </div>
                <div class="cart-item-price cart-item-price-cart">
                  245,000 VND x 1
                </div>
                <a
                  href="#"
                  onclick="showAddNotePopup(
          (note) => {
            console.log('Note added:', note); // Handle the note input
          },
          () => {
            console.log('Note addition cancelled');
          }
        )"
                  class="add-note"
                  >Thêm ghi chú</a
                >
                <div class="cart-item-controls">
                  <button class="decrease-quantity quantity-cart">-</button>
                  <span class="cart_quantity quantity-cart span-quantity"
                    >1</span
                  >
                  <button class="increase-quantity quantity-cart">+</button>
                  <button class="remove-item">Xóa</button>
                </div>
              </div>
            </div>
            <!-- <div class="product-card">
              <img
                src="../assets/img/products/PZ_Margherita.webp"
                alt="Pizza Margherita"
              />
              <div class="product-details">
                <h3>Pizza Margherita</h3>
                <p>
                  (Món chay) Bạn sẽ bất ngờ trước sự hợp cạ của bộ đôi “phô
                  mai-mật ong” này đấy!
                </p>
                <p class="price">100.000đ</p>
                <div class="quantity-controls">
                  <button class="decrease-btn">-</button>
                  <span class="quantity">1</span>
                  <button class="increase-btn">+</button>
                  <button class="remove-btn">Xóa</button>
                </div>
              </div>
            </div>
            <div class="product-card">
              <img
                src="../assets/img/products/PZ_haisancay&pmhunkhoi.webp"
                alt="Pizza Pepperoni"
              />
              <div class="product-details">
                <h3>Pizza Pepperoni</h3>
                <p>
                  (Món chay) Bạn sẽ bất ngờ trước sự hợp cạ của bộ đôi “phô
                  mai-mật ong” này đấy!
                </p>
                <p class="price">120.000đ</p>
                <div class="quantity-controls">
                  <button class="decrease-btn">-</button>
                  <span class="quantity">1</span>
                  <button class="increase-btn">+</button>
                  <button class="remove-btn">Xóa</button>
                </div>
              </div>
            </div>
            <div class="product-card">
              <img
                src="../assets/img/products/PZ_Hawaiian.webp"
                alt="Pizza Hawaiian"
              />
              <div class="product-details">
                <h3>Pizza Hawaiian</h3>
                <p>
                  Dòng pizza 3 loại phô mai nhà làm gồm: phô mai Mozzarella,
                  Grano Padano và Camembert.
                </p>
                <p class="price">110.000đ</p>
                <div class="quantity-controls">
                  <button class="decrease-btn">-</button>
                  <span class="quantity">1</span>
                  <button class="increase-btn">+</button>
                  <button class="remove-btn">Xóa</button>
                </div>
              </div>
            </div> -->
          </div>
        </div>

        <div class="checkout-form">
          <!-- Địa chỉ giao hàng -->
          <div class="form-section">
            <h2>Địa Chỉ Giao Hàng</h2>
            <div class="address-option">
              <input
                type="radio"
                name="address-type"
                id="saved-address"
                checked
              />
              <label for="saved-address">Sử dụng địa chỉ đã lưu</label>
            </div>
            <div class="address-option">
              <input type="radio" name="address-type" id="new-address" />
              <label for="new-address">Nhập địa chỉ mới</label>
            </div>

            <div class="saved-addresses active">
              <select class="form-group">
                <option>Nguyễn Văn A - 123 Đường Pizza, Quận 1, TP.HCM</option>
                <option>
                  Trần Thị B - 456 Đường Margherita, Quận 2, TP.HCM
                </option>
              </select>
            </div>

            <div class="new-address">
              <div class="form-row">
                <div class="form-group">
                  <label>Họ</label>
                  <input type="text" placeholder="Nhập họ" />
                </div>
                <div class="form-group">
                  <label>Tên</label>
                  <input type="text" placeholder="Nhập tên" />
                </div>
              </div>
              <div class="form-group">
                <label>Số Điện Thoại</label>
                <input type="tel" placeholder="Nhập số điện thoại" />
              </div>
              <div class="form-group">
                <label>Địa Chỉ Chi Tiết</label>
                <input type="text" placeholder="Nhập số nhà, tên đường" />
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label>Tỉnh/Thành Phố</label>
                  <select>
                    <option>Chọn Thành Phố</option>
                    <option>Hồ Chí Minh</option>
                    <option>Hà Nội</option>
                    <option>Đà Nẵng</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>Quận/Huyện</label>
                  <select>
                    <option>Chọn Quận/Huyện</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <!-- Phương thức thanh toán -->
          <div class="form-section">
            <h2>Phương Thức Thanh Toán</h2>
            <div class="payment-methods">
              <div class="payment-method" data-method="cash">Tiền Mặt</div>
              <div class="payment-method" data-method="bank">Chuyển Khoản</div>
              <div class="payment-method" data-method="card">
                Thanh Toán Thẻ
              </div>
            </div>

            <!-- Chi tiết thanh toán thẻ -->
            <div class="payment-details card-form">
              <div class="form-group">
                <label>Số Thẻ</label>
                <input type="text" placeholder="1234 5678 9012 3456" />
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label>Ngày Hết Hạn</label>
                  <input type="text" placeholder="MM/YY" />
                </div>
                <div class="form-group">
                  <label>CVV</label>
                  <input type="text" placeholder="123" />
                </div>
              </div>
              <div class="form-group">
                <label>Tên Trên Thẻ</label>
                <input type="text" placeholder="NGUYEN VAN A" />
              </div>
            </div>
          </div>

          <!-- Ghi chú -->
          <div class="form-section">
            <h2>Ghi Chú</h2>
            <textarea
              class="order-note"
              rows="4"
              placeholder="Nhập ghi chú đơn hàng (nếu có)"
            ></textarea>
          </div>

          <button id="view-summary-btn" class="datHang-btn">
            Xem Tóm Tắt Đơn Pizza
          </button>
          <button
            onclick="toast({
            title: 'Đặt hàng thành công',
            message: 'Đơn hàng của bạn đã được ghi nhận',
            type: 'success'
          })"
            class="datHang-btn"
            style="margin-top: 15px"
          >
            Đặt hàng
          </button>
        </div>
      </div>

      <!-- Modal Tóm Tắt Đơn Hàng -->
      <div class="order-summary-modal" id="order-summary-modal">
        <div class="order-summary-content">
          <span class="modal-close" id="close-summary">×</span>
          <h2>Chi Tiết Đơn Pizza</h2>

          <div class="form-section">
            <h3>Thông Tin Sản Phẩm</h3>
            <div class="summary-item">
              <span>Pizza Margherita</span>
              <span>Số lượng: 2</span>
              <span>200.000đ</span>
            </div>
            <div class="summary-item">
              <span>Pizza Pepperoni</span>
              <span>Số lượng: 1</span>
              <span>150.000đ</span>
            </div>
            <div class="summary-item">
              <span>Pizza Hawaiian</span>
              <span>Số lượng: 1</span>
              <span>180.000đ</span>
            </div>
          </div>

          <div class="form-section">
            <h3>Thông Tin Giao Hàng</h3>
            <p>Nguyễn Văn A</p>
            <p>Số điện thoại: 0123 456 789</p>
            <p>Địa chỉ: 123 Đường Pizza, Quận 1, TP.HCM</p>
          </div>

          <div class="form-section">
            <h3>Phương Thức Thanh Toán</h3>
            <p>Thanh toán khi nhận hàng</p>
          </div>

          <div class="form-section">
            <h3>Chi Phí</h3>
            <div class="summary-total">
              <span>Tổng Tiền Hàng</span>
              <span>530.000đ</span>
            </div>
            <div class="summary-total">
              <span>Phí Vận Chuyển</span>
              <span>30.000đ</span>
            </div>
            <div class="summary-total" style="color: #242e52; font-size: 1.2em">
              <span>Tổng Thanh Toán</span>
              <span>560.000đ</span>
            </div>
          </div>
        </div>
      </div>
    </main>
    <footer>
      <div class="footer__container">
        <div class="footer__row">
          <!-- Footer column 1 -->
          <div class="footer__col">
            <!-- Logo -->
            <a href="./" class="logo footer__logo">
              <h1 class="logo__title">pizza 4ps</h1>
            </a>
            <p class="footer__desc">
              Chúng tôi cam kết mang đến cho khách hàng những trải nghiệm ẩm
              thực tuyệt vời với các món pizza được làm từ nguyên liệu tươi ngon
              và công thức độc đáo.
            </p>

            <p class="footer__help-text">
              Nhận thông tin mới nhất từ chúng tôi.
            </p>
            <div action="" class="footer__form">
              <input
                type="text"
                class="footer__input"
                placeholder="Email address"
              />
              <button
                onclick="toast({
              title: 'Thông báo',
              message: 'Chức năng này đang được phát triển',
              type: 'info',
              duration: 3000
              })"
                class="my_btn btn--primary"
              >
                GỬI
              </button>
            </div>
          </div>

          <!-- Footer column 2 -->
          <div class="footer__col">
            <h3 class="footer__heading">Nhà hàng</h3>
            <ul class="footer__list">
              <li>
                <a href="#!" class="footer__link">Hà Nội</a>
              </li>
              <li>
                <a href="#!" class="footer__link">Hồ Chí Minh</a>
              </li>
              <li>
                <a href="#!" class="footer__link">Hải Phòng</a>
              </li>
              <li>
                <a href="#!" class="footer__link">Đà Nẵng</a>
              </li>
              <li>
                <a href="#!" class="footer__link">Bình Dương</a>
              </li>
            </ul>
          </div>

          <!-- Footer column 3 -->
          <div class="footer__col">
            <h3 class="footer__heading">Dịch vụ</h3>
            <ul class="footer__list">
              <li>
                <a href="#!" class="footer__link">Chính sách giao hàng</a>
              </li>
              <li>
                <a href="#!" class="footer__link"
                  >Chính sách đổi trả và hoàn tiền</a
                >
              </li>
            </ul>
          </div>

          <!-- Footer column 4 -->
          <div class="footer__col">
            <h3 class="footer__heading">Chính sách</h3>
            <ul class="footer__list">
              <li>
                <a href="#!" class="footer__link"
                  >Chính sách và quy định chung</a
                >
              </li>
              <li>
                <a href="#!" class="footer__link">Chính sách thanh toán</a>
              </li>
              <li>
                <a href="#!" class="footer__link"
                  >Chính sách quy định E-Voucher</a
                >
              </li>
              <li>
                <a href="#!" class="footer__link">Careers</a>
              </li>
              <li>
                <a href="#!" class="footer__link">About</a>
              </li>
              <li>
                <a href="#!" class="footer__link">Affiliates</a>
              </li>
            </ul>
          </div>

          <!-- Footer column 5 -->
          <div class="footer__col">
            <h3 class="footer__heading">Contact</h3>
            <ul class="footer__list">
              <li>
                <p class="footer__label">Email</p>
                <a href="mailto:ngoctinn.work@gmail.com" class="footer__link">
                  ngoctinn.work@gmail.com
                </a>
              </li>
              <li>
                <p class="footer__label">Hotline</p>
                <a href="tel:18008888" class="footer__link">18008888</a>
              </li>
              <li>
                <p class="footer__label">Address</p>
                <p class="footer__text">
                  273 An Dương Vương, Quận 5, Thành phố Hồ Chí Minh, Việt Nam.
                </p>
              </li>
              <li>
                <p class="footer__label">Giờ</p>
                <p class="footer__text">2 - CN 08:00am - 10:00pm</p>
              </li>
            </ul>
          </div>
        </div>
        <div class="footer__bottom">
          <p class="footer__copyright">
            Bản quyền © 2024 Pizza 4P’s. Đã đăng ký Bản quyền
          </p>

          <div class="footer__socials">
            <a
              href="#!"
              class="footer__social-link footer__social-link--facebook"
            >
              <img
                src="../assets/icons/facebook.svg"
                alt=""
                class="footer__social-icon"
              />
            </a>
            <a
              href="#!"
              class="footer__social-link footer__social-link--youtube"
            >
              <img
                src="../assets/icons/youtube.svg"
                alt=""
                class="footer__social-icon"
              />
            </a>
            <a
              href="#!"
              class="footer__social-link footer__social-link--tiktok"
            >
              <img
                src="../assets/icons/tiktok.svg"
                alt=""
                class="footer__social-icon"
              />
            </a>
            <a
              href="#!"
              class="footer__social-link footer__social-link--twitter"
            >
              <img
                src="../assets/icons/twitter.svg"
                alt=""
                class="footer__social-icon"
              />
            </a>
            <a
              href="#!"
              class="footer__social-link footer__social-link--linkedin"
            >
              <img
                src="../assets/icons/linkedin.svg"
                alt=""
                class="footer__social-icon"
              />
            </a>
          </div>
        </div>
      </div>
    </footer>
    <div id="popup-overlay" class="popup-overlay">
      <div class="popup-box">
        <h3 id="popup-title">Confirm Action</h3>
        <p id="popup-message">Are you sure?</p>
        <div class="popup-buttons">
          <button class="cancel-btn" onclick="closePopup()">Hủy bỏ</button>
          <button class="confirm-btn" onclick="handleConfirm()">
            Xác nhận
          </button>
        </div>
      </div>
    </div>
    <div id="toast"></div>

    <script>
      //     function renderProductList() {
      //       const currentUser = localStorage.getItem("currentUser");
      //       const products = JSON.parse(localStorage.getItem("products"));
      //       const cartList = document.querySelector(".product-list");
      //       const cart = JSON.parse(currentUser).cart;
      //       let totalQuantity = 0;
      //       let totalPrice = 0;
      //       cartList.innerHTML = "";

      //       cart.forEach((cartItem) => {
      //         const product = products.find((p) => p.id === cartItem.id);
      //         if (product) {
      //           totalQuantity += cartItem.quantity;
      //           totalPrice +=
      //             parseInt(product.price.replace(/[^0-9]/g, "")) *
      //             cartItem.quantity;

      //           const cartItemElement = document.createElement("div");
      //           cartItemElement.classList.add("cart-item");
      //           cartItemElement.classList.add("cart-item-cart");

      //           cartItemElement.innerHTML = `
      //       <img src="${product.image}" alt="${product.name}" class="cart-item-image cart-item-image-cart" />
      //       <div class="cart-item-details">
      //         <div class="cart-item-name cart-item-name-cart">${product.name}</div>
      //         <div class="cart-item-price cart-item-price-cart">${product.price} x ${cartItem.quantity}</div>
      //         <a href="#" onclick="showAddNotePopup(
      //   (note) => {
      //     console.log('Note added:', note); // Handle the note input
      //   },
      //   () => {
      //     console.log('Note addition cancelled');
      //   }
      // )" class="add-note">Thêm ghi chú</a>
      //         <div class="cart-item-controls">
      //       <button class="decrease-quantity quantity-cart">-</button>
      //       <span class="cart_quantity quantity-cart span-quantity">${cartItem.quantity}</span>
      //       <button class="increase-quantity quantity-cart">+</button>
      //       <button class="remove-item">Xóa</button>

      //         </div>
      //       </div>
      //     `;
      //           cartList.appendChild(cartItemElement);

      //           // Add event listeners for the buttons
      //           cartItemElement
      //             .querySelector(".decrease-quantity")
      //             .addEventListener("click", () => {
      //               const quantityElement =
      //                 cartItemElement.querySelector(".cart_quantity");
      //               let quantity = parseInt(quantityElement.textContent);
      //               if (quantity > 1) {
      //                 quantity--;
      //                 quantityElement.textContent = quantity;

      //                 // Update quantity in local storage
      //                 const currentUser = JSON.parse(
      //                   localStorage.getItem("currentUser")
      //                 );
      //                 const cart = currentUser.cart;
      //                 const productIndex = cart.findIndex(
      //                   (item) => item.id === cartItem.id
      //                 );
      //                 if (productIndex !== -1) {
      //                   cart[productIndex].quantity = quantity;
      //                   currentUser.cart = cart;
      //                   localStorage.setItem(
      //                     "currentUser",
      //                     JSON.stringify(currentUser)
      //                   );
      //                   renderProductList();
      //                 }
      //               } else {
      //                 showConfirmPopup(
      //                   "Xác nhận",
      //                   "Bạn có chắc chắn muốn xóa sản phẩm này khỏi giỏ hàng không?",
      //                   () => {
      //                     const newCart = cart.filter(
      //                       (item) => item.id !== cartItem.id
      //                     );
      //                     const currentUser = JSON.parse(
      //                       localStorage.getItem("currentUser")
      //                     );
      //                     currentUser.cart = newCart;
      //                     localStorage.setItem(
      //                       "currentUser",
      //                       JSON.stringify(currentUser)
      //                     );
      //                     showCart();
      //                     renderProductList();
      //                   }
      //                 );
      //               }
      //             });

      //           cartItemElement
      //             .querySelector(".increase-quantity")
      //             .addEventListener("click", () => {
      //               const quantityElement =
      //                 cartItemElement.querySelector(".cart_quantity");
      //               let quantity = parseInt(quantityElement.textContent);
      //               quantity++;
      //               quantityElement.textContent = quantity;

      //               // Update quantity in local storage
      //               const currentUser = JSON.parse(
      //                 localStorage.getItem("currentUser")
      //               );
      //               const cart = currentUser.cart;
      //               const productIndex = cart.findIndex(
      //                 (item) => item.id === cartItem.id
      //               );
      //               if (productIndex !== -1) {
      //                 cart[productIndex].quantity = quantity;
      //                 currentUser.cart = cart;
      //                 localStorage.setItem(
      //                   "currentUser",
      //                   JSON.stringify(currentUser)
      //                 );
      //                 renderProductList();
      //               }
      //             });

      //           cartItemElement
      //             .querySelector(".remove-item")
      //             .addEventListener("click", () => {
      //               showConfirmPopup(
      //                 "Xác nhận",
      //                 "Bạn có chắc chắn muốn xóa sản phẩm này khỏi giỏ hàng không?",
      //                 () => {
      //                   const newCart = cart.filter(
      //                     (item) => item.id !== cartItem.id
      //                   );
      //                   const currentUser = JSON.parse(
      //                     localStorage.getItem("currentUser")
      //                   );
      //                   currentUser.cart = newCart;
      //                   localStorage.setItem(
      //                     "currentUser",
      //                     JSON.stringify(currentUser)
      //                   );
      //                   showCart();
      //                   renderProductList();
      //                 }
      //               );
      //             });
      //         }
      //       });

      //       document.querySelector(".cart-count").textContent = totalQuantity;
      //       document.querySelector(
      //         ".cart-total span:last-child"
      //       ).textContent = `${totalPrice.toLocaleString()} VND`;
      //     }
      //     document.addEventListener("DOMContentLoaded", function () {
      //       renderProductList();
      //     });
      // Xử lý chọn địa chỉ
      document
        .querySelectorAll('input[name="address-type"]')
        .forEach((radio) => {
          radio.addEventListener("change", function () {
            const savedAddresses = document.querySelector(".saved-addresses");
            const newAddress = document.querySelector(".new-address");

            if (this.id === "saved-address") {
              savedAddresses.classList.add("active");
              newAddress.classList.remove("active");
            } else {
              savedAddresses.classList.remove("active");
              newAddress.classList.add("active");
            }
          });
        });

      // Xử lý chọn phương thức thanh toán
      document.querySelectorAll(".payment-method").forEach((method) => {
        method.addEventListener("click", function () {
          // Bỏ chọn các phương thức khác
          document
            .querySelectorAll(".payment-method")
            .forEach((m) => m.classList.remove("selected"));
          this.classList.add("selected");

          // Ẩn hiện chi tiết thanh toán
          const paymentDetails = document.querySelector(".payment-details");
          paymentDetails.classList.remove("active");

          if (this.dataset.method === "card") {
            paymentDetails.classList.add("active");
          }
        });
      });

      // Xử lý modal tóm tắt đơn hàng
      const summaryModal = document.getElementById("order-summary-modal");
      const viewSummaryBtn = document.getElementById("view-summary-btn");
      const closeSummary = document.getElementById("close-summary");

      viewSummaryBtn.addEventListener("click", function () {
        summaryModal.style.display = "flex";
      });

      closeSummary.addEventListener("click", function () {
        summaryModal.style.display = "none";
      });

      window.addEventListener("click", function (e) {
        if (e.target === summaryModal) {
          summaryModal.style.display = "none";
        }
      });

      window.addEventListener("keydown", function (e) {
        if (e.key === "Escape") {
          summaryModal.style.display = "none";
        }
      });

      // Xử lý tăng giảm số lượng và xóa sản phẩm
      document.querySelectorAll(".product-card").forEach((card) => {
        const decreaseBtn = card.querySelector(".decrease-btn");
        const increaseBtn = card.querySelector(".increase-btn");
        const quantitySpan = card.querySelector(".quantity");
        const removeBtn = card.querySelector(".remove-btn");
        const price = parseInt(
          card.querySelector(".price").innerText.replace(/\D/g, "")
        );

        decreaseBtn.addEventListener("click", () => {
          let qty = parseInt(quantitySpan.innerText);
          if (qty > 0) {
            qty--;
            quantitySpan.innerText = qty;
            updateTotal();
            // nếu số lượng = 0 thì xóa sản phẩm
            if (qty === 0) {
              showConfirmPopup(
                "Xóa sản phẩm",
                "Bạn có chắc muốn xóa sản phẩm này?",
                () => {
                  card.remove();
                }
              );
            }
          }
        });

        increaseBtn.addEventListener("click", () => {
          let qty = parseInt(quantitySpan.innerText);
          qty++;
          quantitySpan.innerText = qty;
          updateTotal();
        });

        removeBtn.addEventListener("click", () => {
          showConfirmPopup(
            "Xóa sản phẩm",
            "Bạn có chắc muốn xóa sản phẩm này?",
            () => {
              console.log("Xóa sản phẩm");
            }
          );
        });
      });

      // function updateTotal() {
      //   let total = 0;
      //   document.querySelectorAll(".product-card").forEach((card) => {
      //     const qty = parseInt(card.querySelector(".quantity").innerText);
      //     const price = parseInt(
      //       card.querySelector(".price").innerText.replace(/\D/g, "")
      //     );
      //     total += qty * price;
      //   });
      //   document.querySelector(".summary-total span:nth-child(2)").innerText =
      //     total.toLocaleString("vi-VN") + "đ";
      // }
      // const cartWrapper = document.querySelector(".cart-wrapper");

      // // thông báo đang trong giỏ hàng
      // cartWrapper.addEventListener("click", function (e) {
      //   toast({
      //     title: "Thông báo",
      //     message: "Bạn đang trong giỏ hàng",
      //     type: "info",
      //   });
      // });

      function logout_cart() {
        showConfirmPopup(
          "Đăng xuất",
          "Trang giỏ hàng sẽ không còn khả dụng. Bạn có chắc chắn muốn đăng xuất?",
          function () {
            const currentUser = JSON.parse(localStorage.getItem("currentUser"));
            if (currentUser) {
              const users = JSON.parse(localStorage.getItem("users")) || [];
              const userIndex = users.findIndex(
                (user) => user.account === currentUser.account
              );
              if (userIndex !== -1) {
                users[userIndex].cart = currentUser.cart;
                localStorage.setItem("users", JSON.stringify(users));
              }
            }
            localStorage.removeItem("currentUser");
            window.location.href = "index.html"; // Redirect to index page
          }
        );
      }
    </script>
    <script src="../assets/bootstrap-5.3.3-dist/js/bootstrap.min.js"></script>
    <script src="../assets/js/products.js"></script>
    <script src="../assets/js/notification.js"></script>
    <script src="../assets/js/flickity.pkgd.min.js"></script>
  </body>
</html>
